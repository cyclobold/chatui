<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="receive_chat_style.css">
    
    
</head>
<body>
        
        <div class="container">
            <div class='starting-soon'>
                Chat Interface is Starting soon ...
                <form id='loading-receive-chat-interface' style='visibility: hidden;' action='#'>
                    <input type='hidden' name='connection_key' id='connection-key'>
                    <button></button>
                </form>

            </div>
            
            <div class="chatbox">
                <div class="col-1">
                
                    <div class="msg-row msg-row2">
                        <!-- <img src="image/img-three.png" alt="msg-img" class="pic2"> -->
                        <div class="msg-text">
                            <h2>Hello</h2>
                            <p>This is the beginning of your chat with Peer...<br> Type your first message</p>
                        </div>
                    </div>
                    <!-- <div class="msg-row">
                        <div class="msg-text">
                            <h2>Peer</h2>
                            <p>I love you more.</p>
                        </div>
                        <img src="image/img-one.png" alt="msg-img" class="pic">
                    </div> -->
                    <hr>
                    <div class="send-area">
                        <input type="text" placeholder="Type your messages here..." >
                        <button class='send-btn'>Send</button>
                    </div>
    
                </div>
            </div>
        </div>



        <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>
        <script src="https://unpkg.com/peerjs@1.3.1/dist/peerjs.min.js"></script>
        <script src="vendors/js/loaders.js"></script>
        <script>
            //Get started ..
            let peerKey = localStorage.getItem("peer-key");
            
            //submit
            LoadingChatInterfaceForm = document.querySelector("#loading-receive-chat-interface");

            //manually submit

            let peer = new Peer();
            
            setTimeout(function(){
                //LoadingChatInterfaceForm.submit();
               
                //pick this up
                LoadingChatInterfaceForm.addEventListener("submit", function(e){
                    e.preventDefault();
                    //once submitted 

                    conn = peer.connect(peerKey);

                    conn.on("open", function(){

                        console.log("COnnected: ", conn.peer);

                        //reset the style ..
                        document.querySelector(".starting-soon").style.display = "none";
                        document.querySelector(".chatbox").style.display = "flex";


                        conn.on("data", function(data){

                            console.log("Message: ", data)

                        })

                        conn.send("From here")

                    })

                   




                    return false;

                })
                LoadingChatInterfaceForm.dispatchEvent(new Event("submit"));

            }, 3000);

          
    

        </script>
 
</body>
</html>